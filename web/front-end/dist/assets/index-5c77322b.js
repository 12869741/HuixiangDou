var ce=Object.defineProperty;var re=(e,s,a)=>s in e?ce(e,s,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[s]=a;var K=(e,s,a)=>(re(e,typeof s!="symbol"?s+"":s,a),a);import{m as y,a as le,q as de,b as pe,j as t,I as ue,O as he,u as me,c as R,S as ge,M as $,C as z,d as T,T as fe,F as P,B as _e,R as ve,e as C,N as xe,f as je}from"./vendor-3bf7735b.js";function Ss(){import.meta.url,import("_").catch(()=>1);async function*e(){}}(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const c of i)if(c.type==="childList")for(const d of c.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&n(d)}).observe(document,{childList:!0,subtree:!0});function a(i){const c={};return i.integrity&&(c.integrity=i.integrity),i.referrerPolicy&&(c.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?c.credentials="include":i.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function n(i){if(i.ep)return;i.ep=!0;const c=a(i);fetch(i.href,c)}})();window.mlog=null;class be{constructor(){K(this,"log")}static init(){return Promise.resolve(null)}static configUserId(s){}static sendEvent(s,a){}}const ye="https://openmmlab-share.oss-cn-hangzhou.aliyuncs.com/metadata/seal-lion-client-meta-data.js",we=e=>new Promise((s,a)=>{let n=document.createElement("script");n.src="".concat(e,"?random=").concat(Date.now()),n.type="text/javascript";const i=()=>{document.body.removeChild(n),n=null};window.sealionJSONPCallback=c=>{s(c),i()},n.onerror=c=>{a(c),i()},document.body.appendChild(n)}),ke=({open:e=!1,grayscale:s="100%",changePages:a="all",routerType:n="popstate"})=>{if(!e)return;const i=()=>{document.body.style.cssText="-webkit-filter: grayscale(".concat(s,");-ms-filter: grayscale(").concat(s,");-moz-filter: grayscale(").concat(s,");filter: grayscale(").concat(s,");")},c=()=>{document.body.style.cssText=""};(r=>{const u=(o,p)=>{n===p&&(r==null||r(o,p))};window.addEventListener("load",()=>{const o=n==="popstate"?window.location.pathname:window.location.hash;r(o,"init")},!1),window.addEventListener("popstate",()=>{u(window.location.pathname,"popstate")},!1),window.addEventListener("hashchange",()=>{u(window.location.hash,"hashchange")},!1)})(r=>{a==="all"||a.some(u=>u===r)?i():c()})},Se=async()=>{try{const s=(await we(ye)||{}).grayPage;ke(s)}catch(e){console.error(e)}};Se();const B="production",Ie=!1,Ne={development:"",staging:"",production:""},Ce={development:"",staging:"",production:"https://sso.openxlab.org.cn"},Re={development:"",staging:"",production:"opencompass.org.cn"},Te=Ne[B],Ee=Ce[B],Le=Re[B],Pe=["/account/oauth","/api/v1/access/v1/login","/api/v1/statistic/v1/total"],We={development:"",staging:"",production:""},$e={mock:"",development:"",staging:"",production:""},Z="production",De=We[Z],H=$e[Z],Fe=e=>{const s=lt.get(),a={lang:E(),...e.headers};return!Pe.find(n=>(e.url||"").endsWith(n))&&Ie&&(a.Authorization="Bearer ".concat(s)),{...e,headers:a}},Ae=e=>({...e,headers:{...e.headers,"Client-Type":"app",type:0}}),Me=[Fe,Ae],S="";var w=(e=>(e.success="10000",e.notAuthed="A1000",e.createFail="A2000",e.loginFail="A2001",e.notExist="A2002",e))(w||{});async function qe(){return j("/api/v1/statistic/v1/total",{method:"GET"},S)}async function Oe(e,s){return j("/api/v1/access/v1/login",{method:"POST",data:{name:e,password:s},meta:{isAllResponseBody:!0}},S)}async function Be(){return j("/api/v1/qalib/v1/getInfo",{method:"POST"},S)}async function Ue(e){const s=new FormData;for(let a=0;a<e.length;a++){const n=e[a];s.append("files",n)}return j("/api/v1/qalib/v1/addDocs",{method:"POST",data:s})}async function Ke(e,s){return j("/api/v1/qalib/v1/updateSampleInfo",{method:"POST",data:{positives:e,negatives:s}},S)}async function ze(){return j("/api/v1/qalib/v1/getSampleInfo",{method:"POST"},S)}async function G(e){return j("/api/v1/qalib/v1/integrateWebSearch",{method:"POST",data:{webSearchToken:e,vendor:"google"},meta:{isAllResponseBody:!0}},S)}async function He(e,s){return j("/api/v1/qalib/v1/integrateLark",{method:"POST",data:{appId:e,appSecret:s},meta:{isAllResponseBody:!0}},S)}async function Ge(e){return j("/api/v1/chat/v1/online",{method:"POST",data:e},S)}async function Ve(e){return j("/api/v1/chat/v1/onlineResponse",{method:"POST",data:{queryId:e}},S)}const Je=e=>{const s=e.data;return e.__meta.isAllResponseBody?s:s.data},Qe=e=>{const s=e.data,n=!e.__meta.isIgnoreError;return s.success===!1&&n&&y.error(s.msg),e},Xe=e=>{const s=e.data;return s&&[w.notAuthed,w.loginFail].includes(s.msgCode),e},Ye=e=>{const s=e.data;return s&&s.msgCode==="C1600"&&(window.location.href=dt()),e},F=(e,s=!1)=>{s||y.error(e)},Ze=e=>{if(e.response){const a=e.__meta.isIgnoreGatewayError,n=e.response.status;switch(console.log(e.code,"error....."),n){case 401:case 403:break;case 500:F(E()==="zh-CN"?"服务器没有响应，请稍后再试":"Sever error, please try again later.",a);break;default:e.code==="ERR_NETWORK"?F(E()==="zh-CN"?"网络出错了，请稍后再试":"Network error, please try again later.",a):F("".concat(n,": ").concat(e.message||"unknown error"),a)}}return Promise.reject(e)},ee=[Xe,Ye,Qe,Je],te=[Ze],U=(...e)=>{const s=e.map(a=>typeof a=="function"?a:()=>a);return(...a)=>{let n=0,i;for(i=s.length===0?a:s[n++](...a);n<s.length;)i=s[n++](i);return i}},N=le.create({method:"get",timeout:3e5,responseType:"json",paramsSerializer:e=>de.stringify(e,{indices:!1})}),W=new Map,se=e=>{let s={};return W.has(e)&&(s=W.get(e),W.delete(e)),s},et=e=>({...e,__meta:se(e.config.url)}),tt=e=>{const{response:s}=e;return{...e,__meta:se(s.config.url)}};ee.unshift(et);te.unshift(tt);const st=U(...Me),nt=U(...ee),at=U(...te);N.interceptors.request.use(st,e=>Promise.reject(e));N.interceptors.response.use(nt,at);const ot=(e,{method:s="GET",params:a={},data:n={},...i})=>{const c="".concat(De).concat(e);switch(s.toLowerCase()){case"get":return N.get(c,{params:a,...i});case"delete":return N.delete(c,{params:a,data:n,...i});case"post":return N.post(c,n,{params:a,...i});case"put":return N.put(c,n,{params:a,...i});default:return N.get(c,{params:a,...i})}},j=(e,s={},a=H)=>{const n=a||H,i="".concat(n,"/").concat(e).replace(/\/\//g,"/");return s.meta&&(W.set(i,s.meta),delete s.meta),ot(i,s)},O="locale",it=()=>{const e=window.localStorage.getItem(O);return e?e==="en-US"?"en-US":"zh-CN":(localStorage.setItem(O,"en-US"),"en-US")};let ne=it();const ct=e=>(window.localStorage.setItem(O,e),e),E=()=>ne,rt=e=>{ne=ct(e)},V=e=>{const s=document.cookie.split(";");for(let a=0;a<s.length;a++)if(s[a].split("=")[0].trim()===e){const i=new Date;i.setTime(i.getTime()-60),document.cookie="".concat(s[a],";expires=").concat(i.toUTCString(),";path=/;domain=").concat(Le);break}},lt={tokenKey:"hxd_token",cookieTokenKey:"hxd_token",getFromCookie(){return pe.get(this.cookieTokenKey)},storage(e){return e==null?(console.log("[Token]: ".concat(e," is invalidate")),!1):(localStorage.setItem(this.tokenKey,e),!0)},update(e){localStorage.getItem(this.tokenKey)!==e&&this.storage(e)},get(){const e=this.getFromCookie();return this.update(e),e||localStorage.getItem(this.tokenKey)},has(){return!!this.get()},removeAll(){V(this.cookieTokenKey),V("ssouid"),localStorage.removeItem(this.tokenKey)}},dt=()=>{let e=window.location.href;const s=new URL(e);return s.searchParams.has("code")&&(s.searchParams.delete("code"),s.searchParams.has("lang")&&s.searchParams.delete("lang"),e=s.toString()),"".concat(Ee,"/authentication?redirect=").concat(e,"&clientId=").concat(Te,"&lang=").concat(E())},pt=e=>{},ut={locale:"",setLocale:pt},ae=React.createContext(ut),ht=({children:e})=>{const[s,a]=React.useState(E()),n=React.useCallback(c=>{a(c),rt(c)},[]),i=React.useMemo(()=>({locale:s,setLocale:n}),[s,n]);return t.jsx(ue,{locale:s,children:t.jsx(ae.Provider,{value:i,children:e})})},J={},mt=()=>t.jsx("div",{className:J.wrapper,children:t.jsx("div",{className:J.body,children:t.jsx(he,{})})}),gt={home:{beanName:"请输入知识库名称，不存在则自动创建。不少于 8 个字符",createBean:"创建知识库",beanPwd:"知识库密码",create:"创建",cancel:"取消",go:"前往",bean:"知识库",activeBean:"活跃知识库",WeChat:"微信",feishu:"飞书",users:"服务人次",uniqueUsers:"去重服务人次",pwdError:"密码错误",welcome:"Welcome, grateful",hello:"Hi",hi:"Hello",loading:"Loading"}},ft={beanDetail:{accessFeishu:"零开发集成飞书",accessWeChat:"零开发集成微信",viewDetail:"查看教程",switchSearch:"网络搜索开关",examples:"正反例",docs:"查看或上传",viewAndEdit:"查看或编辑",addExamples:"添加正反例",addDocs:"添加文档",chatTest:"聊天测试",openChatTest:"开始测试",beanName:"知识库名称",createFailed:"创建失败",created:"创建完成，尚未添加文档",createSuccess:"创建完成",upload:"选择文件，可以框选多个"}},_t={welcome:"欢迎，感恩",hello:"嗨",hi:"你好",loading:"Loading"},vt={..._t,...gt,...ft},xt={home:{beanName:"请输入知识库名称，不存在则自动创建。不少于 8 个字符",createBean:"创建知识库",beanPwd:"知识库密码",create:"创建",cancel:"取消",go:"前往",bean:"知识库",activeBean:"活跃知识库",WeChat:"微信",feishu:"飞书",users:"服务人次",uniqueUsers:"去重服务人次",pwdError:"密码错误",welcome:"Welcome, grateful",hello:"Hi",hi:"Hello",loading:"Loading"}},jt={beanDetail:{accessFeishu:"零开发集成飞书",accessWeChat:"零开发集成微信",viewDetail:"查看教程",switchSearch:"网络搜索开关",examples:"正反例",docs:"查看或上传",viewAndEdit:"查看或编辑",addExamples:"添加正反例",addDocs:"添加文档",chatTest:"聊天测试",openChatTest:"开始测试",beanName:"知识库名称",createFailed:"创建失败",created:"创建完成，尚未添加文档",createSuccess:"创建完成",upload:"选择文件，可以框选多个"}},bt={welcome:"Welcome, grateful",hello:"Hi",hi:"Hello",loading:"Loading"},yt={...bt,...xt,...jt},A={"zh-CN":vt,"en-US":yt},L=e=>{const[s,a]=React.useState({}),{locale:n}=React.useContext(ae);return React.useEffect(()=>{n&&A[n]&&A[n][e]&&a(A[n][e])},[n,e]),s},oe="/assets/logo-af340389.png",wt="_btn_1n0lh_1",kt="_home_1n0lh_16",St="_wrapper_1n0lh_22",It="_logo_1n0lh_31",Nt="_slogan_1n0lh_37",Ct="_input-wrapper_1n0lh_46",Rt="_btn-wrapper_1n0lh_53",Tt="_cancel-btn_1n0lh_59",Et="_divider_1n0lh_76",Lt="_statistics-wrapper_1n0lh_82",Pt="_statistics-item_1n0lh_89",Wt="_statistics-item-title_1n0lh_89",$t="_statistics-item-number_1n0lh_95",m={btn:wt,home:kt,wrapper:St,logo:It,slogan:Nt,"input-wrapper":"_input-wrapper_1n0lh_46",inputWrapper:Ct,"btn-wrapper":"_btn-wrapper_1n0lh_53",btnWrapper:Rt,"cancel-btn":"_cancel-btn_1n0lh_59",cancelBtn:Tt,divider:Et,"statistics-wrapper":"_statistics-wrapper_1n0lh_82",statisticsWrapper:Lt,"statistics-item":"_statistics-item_1n0lh_89",statisticsItem:Pt,"statistics-item-title":"_statistics-item-title_1n0lh_89",statisticsItemTitle:Wt,"statistics-item-number":"_statistics-item-number_1n0lh_95",statisticsItemNumber:$t},Dt=()=>{const e=me(),[s,a]=React.useState(""),[n,i]=React.useState(""),[c,d]=React.useState(!1),[r,u]=React.useState(null),o=L("home"),p=()=>{a(""),i("")},l=async(h,g)=>{const I=await Oe(h,g);I.msgCode!==w.success&&y.error(I.msg),I.msgCode===w.success&&I.data.featureStoreId&&e("/bean-detail/?bean=".concat(I.data.featureStoreId))},_=()=>{if(s&&s.length<8){y.info("知识库名称不少于 8 个字符");return}s&&s.length>7&&n&&l(s,n)};React.useEffect(()=>{(async()=>{const h=await qe();h&&u(h)})()},[]);const b=React.useMemo(()=>r?[{title:o.bean,key:"bean",number:r.qalibTotal||0},{title:o.WeChat,key:"WeChat",number:r.wechatTotal||0},{title:o.users,key:"users",number:r.servedTotal||0},{title:o.activeBean,key:"activeBean",number:r.lastMonthUsed||0},{title:o.feishu,key:"feishu",number:r.feishuTotal||0},{title:o.uniqueUsers,key:"uniqueUsers",number:r.realServedTotal||0}]:[],[o,r]);return t.jsx("div",{className:m.home,children:t.jsxs("div",{className:m.wrapper,children:[t.jsx("div",{className:m.logo,children:t.jsx("img",{src:oe,alt:"huixiangdou"})}),t.jsx("div",{className:m.slogan,children:"行业知识助手，零开发接入飞书微信"}),t.jsxs("div",{className:m.inputWrapper,children:[t.jsx(R,{placeholder:o.beanName,value:s,max:500,onChange:h=>a(h.target.value)}),t.jsx(R,{placeholder:o.beanPwd,value:n,max:500,onChange:h=>i(h.target.value)})]}),t.jsxs("div",{className:m.btnWrapper,children:[t.jsx("div",{className:m.cancelBtn,onClick:p,children:o.cancel}),t.jsx("div",{className:m.btn,onClick:_,"aria-disabled":!s||!n,children:c?o.create:o.go})]}),t.jsx("div",{className:m.divider}),t.jsx("div",{className:m.statisticsWrapper,children:b.map(h=>t.jsxs("div",{className:m.statisticsItem,children:[t.jsx("div",{className:m.statisticsItemTitle,children:h.title}),t.jsx("div",{className:m.statisticsItemNumber,children:h.number})]},h.key))})]})})},ie="/assets/bean1-002ba51d.png",Ft="_btn_45tb1_1",At={btn:Ft},k=({disabled:e=!1,onClick:s,children:a})=>{const n=()=>{e||s()};return t.jsx("div",{"aria-disabled":e,className:At.btn,onClick:n,children:a})},Mt="_chat_1l0hg_1",qt="_message-list_1l0hg_6",Ot="_avatar_1l0hg_10",Bt="_message-wrapper_1l0hg_17",Ut="_message_1l0hg_6",Kt="_img-wrapper_1l0hg_28",zt="_reference-wrapper_1l0hg_33",Ht="_reference_1l0hg_33",Gt="_input-wrapper_1l0hg_43",Vt="_editor-wrapper_1l0hg_52",Jt="_prompt-editor_1l0hg_68",v={chat:Mt,"message-list":"_message-list_1l0hg_6",messageList:qt,avatar:Ot,"message-wrapper":"_message-wrapper_1l0hg_17",messageWrapper:Bt,message:Ut,"img-wrapper":"_img-wrapper_1l0hg_28",imgWrapper:Kt,"reference-wrapper":"_reference-wrapper_1l0hg_33",referenceWrapper:zt,reference:Ht,"input-wrapper":"_input-wrapper_1l0hg_43",inputWrapper:Gt,"editor-wrapper":"_editor-wrapper_1l0hg_52",editorWrapper:Vt,"prompt-editor":"_prompt-editor_1l0hg_68",promptEditor:Jt},Qt=()=>{const[e,s]=React.useState([]),[a,n]=React.useState(""),[i,c]=React.useState(!1),d=React.useRef(null),r=async()=>{if(a)return;const o=d.current.querySelectorAll("img"),p=Array.from(o).map(g=>g.getAttribute("src")),l=d.current.innerText.trim();if(!l&&p.length===0)return;const _=e.map(g=>({content:g.content,sender:g.sender})),b={sender:0,content:l,code:void 0,state:"",images:p,references:[]};s([...e,b]),d.current.innerHTML="";const h=await Ge({content:l,history:_,images:p});h&&n(h.queryId)},u=o=>{const p=o.code;!i&&p==="Enter"&&!o.shiftKey&&(r(),o.preventDefault())};return React.useEffect(()=>{let o;if(a){let p=0;o=setInterval(()=>{if(p+=1,Ve(a).then(l=>{if(l&&(l.code===0&&l.text||l.code>0)){clearInterval(o),n("");const _={sender:1,content:l.text,code:l.code,state:l.state,images:[],references:l.references};s([...e,_])}}).catch(l=>{console.error(l),clearInterval(o),n("")}),p===30){clearInterval(o),n("");const l={sender:1,content:"请求超时，请稍后再试",code:0,state:"",images:[],references:[]};s([...e,l])}},2e3)}return()=>{clearInterval(o)}},[a]),t.jsxs("div",{className:v.chat,children:[t.jsx("div",{className:v.messageList,children:e.map((o,p)=>t.jsxs("div",{className:v.messageWrapper,children:[t.jsx("div",{className:v.avatar,children:o.sender===0?"🤓":t.jsx("img",{src:ie,alt:"bean"})}),t.jsxs("div",{className:v.message,style:{background:o.sender===1?"#EDFFEA":"#f0f0f0"},children:[t.jsx("div",{className:v.imgWrapper,children:Array.isArray(o.images)&&o.images.length>0&&o.images.map(l=>t.jsx("img",{src:l,style:{height:24},alt:"img"}))}),t.jsx("div",{children:o.content}),Array.isArray(o.references)&&o.references.length>0&&t.jsxs("div",{className:v.referenceWrapper,children:["参考文档:",t.jsx("div",{className:v.reference,children:o.references.join("\n")})]})]})]},o.content+p))}),t.jsxs("div",{className:v.inputWrapper,children:[t.jsx("div",{className:v.editorWrapper,children:t.jsx("div",{contentEditable:!0,spellCheck:!0,ref:d,id:"prompt-textarea",className:v.promptEditor,onKeyDown:u,onCompositionStart:()=>c(!0),onCompositionEnd:()=>c(!1),"data-text":"支持输入文字、图片和 emoji"})}),t.jsx(k,{disabled:!!a,onClick:r,children:"发送"})]})]})},Xt="_toggle-search_10ga9_1",Yt="_token_10ga9_1",Zt="_input-wrapper_10ga9_12",Q={"toggle-search":"_toggle-search_10ga9_1",toggleSearch:Xt,token:Yt,"input-wrapper":"_input-wrapper_10ga9_12",inputWrapper:Zt},es=({refresh:e,webSearchToken:s,children:a})=>{const[n,i]=React.useState(!1),[c,d]=React.useState(""),r=async o=>{console.log("webSearchToken",!!s),s?(await G("")).msgCode===w.success&&(e(),y.success("网络搜索已关闭")):(i(!0),o.preventDefault(),o.stopPropagation())},u=async()=>{const o=await G(c);o.msgCode===w.success&&!c?(e(),y.success("网络搜索已关闭")):o.msgCode===w.success&&c?(e(),y.success("保存成功")):o.msg&&y.error(o.msg)};return React.useEffect(()=>{n||d("")},[n]),t.jsxs("div",{className:Q.toggleSearch,children:[t.jsx(ge,{checked:!!s,onClick:r}),t.jsxs($,{open:n,title:"网络搜索",footer:t.jsx("div",{}),onClose:()=>i(!1),children:[t.jsx("div",{children:"开启网络搜索，知识助手可以综合网络结果和本地文档给出答复"}),t.jsxs("div",{children:["1. 注册"," ",t.jsx("a",{target:"_blank",href:"https://serper.dev/api-key",rel:"noreferrer",children:"Serper"})," ","获取限量免费 token"]}),t.jsx("div",{children:"2. 填入 token, 新 token 会覆盖旧 token "}),t.jsx("div",{children:"3. 如果保存一个空 token， 网络搜索会被关闭"}),t.jsxs("div",{className:Q.inputWrapper,children:[t.jsx(R,{value:c,onChange:o=>d(o.target.value),placeholder:"填入你的token"}),t.jsx(k,{onClick:u,children:"保存"})]})]})]})},ts="_editor_wbs2o_1",M={editor:ts},ss=()=>{const e=L("beanDetail"),[s,a]=React.useState(!1),[n,i]=React.useState(""),[c,d]=React.useState("");React.useEffect(()=>{s&&(async()=>{const o=await ze();o&&(d(o.positives.join("\n")),i(o.negatives.join("\n")))})()},[s]);const r=async()=>{const o=n.split("\n"),p=c.split("\n");await Ke(p,o)},u=React.useMemo(()=>[{key:"positives",label:"设置正例",children:t.jsxs(t.Fragment,{children:[t.jsx("div",{className:M.editor,children:t.jsx(z,{textarea:!0,rows:12,value:c,placeholder:"正例是真实场景中，来自提问者的、须答复的问题，每句话一行，例如：\n你好，我是实习生，请问单位有宿舍么？\n你们的产品和友商对比有啥优势啊？",onChange:o=>d(o)})}),t.jsx(k,{onClick:r,children:"保存"})]})},{key:"negatives",label:"设置反例",children:t.jsxs(t.Fragment,{children:[t.jsx("div",{className:M.editor,children:t.jsx(z,{textarea:!0,rows:12,value:n,placeholder:"反例是真实场景中的闲聊，不应该答复。\n每句一行，例如：\n今天中午吃日料么？\n快看天上有颗流星，快跑",onChange:o=>i(o)})}),t.jsx(k,{onClick:r,children:"保存"})]})}],[n,c,r]);return t.jsxs("div",{className:M.example,children:[t.jsxs(k,{onClick:()=>a(!0),children:[e.viewAndEdit,t.jsx(T,{icon:"icon-FeedbackOutlined"})]}),t.jsx($,{open:s,title:"设置正反例",footer:t.jsx("div",{}),onClose:()=>a(!1),children:t.jsx(fe,{items:u})})]})},ns="_upload_1q4kq_1",as="_desc_1q4kq_11",os="_file-list_1q4kq_15",q={upload:ns,desc:as,"file-list":"_file-list_1q4kq_15",fileList:os},is=".jpg,.png,.jpeg,.bmp,.pdf,.txt,.md,.docx,.doc,.xlsx,.xls,.csv,.java,.cpp,.py,.js,.go",cs=({afterUpload:e,files:s=[],children:a})=>{const n=React.useRef(null),[i,c]=React.useState(!1),[d,r]=React.useState([]),u=()=>{n.current&&n.current.click()},o=l=>{r([...d,...l.target.files])},p=()=>{c(!0),Ue(d).then(l=>{r([]),e&&e()}).finally(()=>{c(!1)})};return t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:q.upload,onClick:u,children:[t.jsx("input",{onChange:o,ref:n,type:"file",accept:is,multiple:!0,max:10,style:{display:"none"}}),a]}),t.jsx("h4",{children:"待上传文档"}),t.jsx("div",{className:q.fileList,children:d.map(l=>t.jsx("div",{children:l.name},l))}),d.length>0&&t.jsx(k,{onClick:p,children:i?"Uploading...":"确认上传"}),t.jsx("h4",{children:"已上传文档"}),t.jsx("div",{className:q.fileList,children:s.map(l=>t.jsx("div",{children:l},l))})]})},rs={},X=({refresh:e,files:s})=>{const a=L("beanDetail"),[n,i]=React.useState(!1),c=()=>{e()};return t.jsxs("div",{className:rs.importDocs,children:[t.jsxs(k,{onClick:()=>i(!0),children:[a.docs,t.jsx(T,{icon:"icon-DocOutlined"})]}),t.jsx($,{open:n,title:a.addDocs,footer:t.jsx("div",{}),onClose:()=>i(!1),children:t.jsxs(cs,{files:s,afterUpload:c,children:[t.jsx(T,{icon:"icon-PlusOutlined"}),t.jsx("div",{children:a.upload})]})})]})},ls="_integrate-feishu_ozvp0_1",ds="_webhook-url_ozvp0_1",Y={"integrate-feishu":"_integrate-feishu_ozvp0_1",integrateFeishu:ls,"webhook-url":"_webhook-url_ozvp0_1",webhookUrl:ds},ps=({feishu:e,refresh:s,children:a})=>{const[n]=P.useForm(),i=L("beanDetail"),[c,d]=React.useState(!1),[r,u]=React.useState(e==null?void 0:e.eventUrl),o=()=>{d(!0)},p=async()=>{n.validateFields().then(async l=>{He(l.appId,l.appSecret).then(_=>{if(_&&_.msgCode===w.success){var b;u((b=_.data)===null||b===void 0?void 0:b.eventUrl),y.success("保存成功"),s()}})})};return React.useEffect(()=>{c&&e?(n.setFieldsValue({...e}),u(e.eventUrl||"")):n.resetFields()},[c,e]),t.jsxs("div",{className:Y.integrateFeishu,children:[r?t.jsx("div",{className:Y.webhookUrl,onClick:o,title:"点击修改",children:r}):t.jsxs(k,{onClick:o,children:[i.viewDetail,t.jsx(T,{icon:"icon-GotoOutline"})]}),t.jsxs($,{open:c,title:"集成飞书",footer:t.jsx("div",{}),onClose:()=>d(!1),children:[t.jsx("div",{children:"完成下面配置后，可以在飞书群聊中跟茴香豆对话"}),r&&t.jsx("div",{children:"eventUrl: ".concat(r)}),t.jsxs(P,{form:n,layout:"vertical",children:[t.jsx(P.Item,{name:"appId",label:"appId",rules:[{required:!0,message:"appId 不能为空"}],children:t.jsx(R,{placeholder:"appId (必填)"})}),t.jsx(P.Item,{name:"appSecret",label:"appSecret",rules:[{required:!0,message:"appSecret 不能为空"}],children:t.jsx(R,{placeholder:"appSecret (必填)"})})]}),t.jsx(k,{onClick:p,children:"提交"})]})]})},us="_btn_ykbi2_1",hs="_bean-detail_ykbi2_18",ms="_logo_ykbi2_28",gs="_bean-state_ykbi2_35",fs="_fail-state_ykbi2_41",_s="_statistics-wrapper_ykbi2_44",vs="_statistics-item_ykbi2_51",xs="_title-img_ykbi2_54",js="_statistics-item-title_ykbi2_57",f={btn:us,"bean-detail":"_bean-detail_ykbi2_18",beanDetail:hs,logo:ms,"bean-state":"_bean-state_ykbi2_35",beanState:gs,"fail-state":"_fail-state_ykbi2_41",failState:fs,"statistics-wrapper":"_statistics-wrapper_ykbi2_44",statisticsWrapper:_s,"statistics-item":"_statistics-item_ykbi2_51",statisticsItem:vs,"title-img":"_title-img_ykbi2_54",titleImg:xs,"statistics-item-title":"_statistics-item-title_ykbi2_57",statisticsItemTitle:js},bs=()=>{const e=L("beanDetail"),[s,a]=React.useState(""),[n,i]=React.useState([]);React.useState(null);const[c,d]=React.useState(null),[r,u]=React.useState(""),[o,p]=React.useState(null),[l,_]=React.useState(!1),b={[-1]:e.createFailed,0:e.created,2:e.createSuccess},h={[-1]:"#f1bcbc",0:"#ffe2bf",2:"#e3f9dd"},g=()=>{_(!l)};React.useEffect(()=>{(async()=>{const x=await Be();if(x){var D;a(x.name),p(x.status),u((D=x.webSearch)===null||D===void 0?void 0:D.token),d(x.lark),i(x.docs)}})()},[l]);const I=React.useMemo(()=>o===0?[{title:e.addDocs,children:t.jsx(X,{files:n,refresh:g}),key:"docs"}]:[{title:e.addDocs,children:t.jsx(X,{files:n,refresh:g}),key:"docs"},{title:e.addExamples,children:t.jsx(ss,{}),key:"examples"},{title:e.accessWeChat,children:t.jsxs("div",{className:f.btn,children:[e.viewDetail,t.jsx(T,{icon:"icon-GotoOutline"})]}),key:"accessWeChat"},{title:e.accessFeishu,children:t.jsx(ps,{feishu:c,refresh:g}),key:"accessFeishu"},{title:e.switchSearch,children:t.jsx(es,{refresh:g,webSearchToken:r}),key:"switchSearch"}],[e,r,o,c,g]);return t.jsxs("div",{className:f.beanDetail,children:[t.jsx("div",{className:f.logo,children:t.jsx("img",{src:oe,alt:"huixiangdou"})}),t.jsxs("div",{className:f.statisticsItem,children:[t.jsxs("div",{className:f.statisticsItemTitle,children:[e.beanName,t.jsx("img",{className:f.titleImg,src:ie})]}),t.jsxs("div",{children:[t.jsx("strong",{children:s}),t.jsx("span",{className:f.beanState,style:{background:h[o]},children:b[o]})]})]}),t.jsx("div",{className:f.statisticsWrapper,children:I.map(x=>t.jsxs("div",{className:f.statisticsItem,children:[t.jsx("div",{className:f.statisticsItemTitle,children:x.title}),t.jsx("div",{children:x.children})]},x.key))}),o>0&&t.jsxs("div",{className:f.statisticsItem,children:[t.jsx("div",{className:f.statisticsItemTitle,children:e.chatTest}),t.jsx("div",{children:t.jsx(Qt,{})})]})]})},ys=()=>t.jsx(_e,{children:t.jsxs(ve,{children:[t.jsxs(C,{path:"/",element:t.jsx(mt,{}),children:[t.jsx(C,{index:!0,element:t.jsx(xe,{to:"home",replace:!0})}),t.jsx(C,{path:"home",element:t.jsx(Dt,{})}),t.jsx(C,{path:"bean-detail",element:t.jsx(bs,{})})]}),t.jsx(C,{path:"*",element:t.jsx("main",{children:t.jsx("p",{children:"There is nothing here!"})})})]})});console.log("production");const ws=()=>t.jsx(ht,{children:t.jsx(ys,{})});be.init();je(document.getElementById("root")).render(t.jsx(React.StrictMode,{children:t.jsx(ws,{})}));export{Ss as __vite_legacy_guard};
